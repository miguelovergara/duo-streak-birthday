<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Duo Streak Birthdays</title>
    <!-- Incluye Tailwind CSS (utilizado para el estilo) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Incluye React, ReactDOM y Babel (para ejecutar el JSX) -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Configuraci√≥n para usar la fuente Inter con Tailwind -->
    <style>
      :root {
        font-family: 'Inter', sans-serif;
      }
    </style>
</head>
<body class="bg-gray-100">

    <div id="root">
        <!-- La aplicaci√≥n React se renderizar√° aqu√≠ -->
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Componente funcional principal
        const App = () => {
          const [streak, setStreak] = useState('');
          const [milestones, setMilestones] = useState([]);
          const [error, setError] = useState('');
          
          // Nuevo estado para el mensaje motivacional
          const [motivationalMessage, setMotivationalMessage] = useState('');
          const [showMotivation, setShowMotivation] = useState(false);

          // Funci√≥n para formatear fechas en espa√±ol
          const formatDate = (date) => {
            return new Intl.DateTimeFormat('es-ES', {
              weekday: 'long',
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            }).format(date);
          };

          // L√≥gica para generar mensajes de sorpresa
          const generateMotivationalMessage = (s) => {
              if (s > 1000) {
                  return `¬°GUAU! ¬°M√°s de un millar de d√≠as! Tu consistencia es √©pica. Sigue as√≠.`;
              } else if (s >= 500) {
                  return `¬°Incre√≠ble, ${s} d√≠as! ¬°Est√°s en la liga de los maestros de la racha!`;
              } else if (s >= 365) {
                  return `¬°Un a√±o entero! ¬°Qu√© logro tan inspirador! A seguir sumando.`;
              } else if (s >= 100) {
                  return `¬°Genial! ¬°Ya tienes una racha de tres cifras! Nada te detiene.`;
              } else if (s > 0) {
                  return `¬°Excelente comienzo! Cada d√≠a cuenta. ¬°Sigue as√≠!`;
              } else {
                  return ``;
              } 
          };

          // Manejador del input para validar enteros >= 0
          const handleStreakChange = (e) => {
            const value = e.target.value;
            
            // Si el usuario comienza a escribir, oculta el mensaje: if (showMotivation) setShowMotivation(false);

            // Si el valor est√° vac√≠o, limpia el error y la racha.
            if (value === '') {
              setStreak('');
              setError('');
              return;
            }

            // Permite solo n√∫meros enteros positivos
            if (/^\d+$/.test(value)) {
              setStreak(value);
              setError('');
            } else {
              // Mantiene el valor actual si la entrada es inv√°lida pero permite la correcci√≥n
              setError('Solo se permiten n√∫meros enteros mayores o iguales a 0.');
            }
          };
          
          // Manejador cuando el input pierde el foco
          const handleBlur = () => {
              const currentStreak = Number(streak);
              if (currentStreak > 0 && !isNaN(currentStreak)) {
                  const msg = generateMotivationalMessage(currentStreak);
                  if (msg) {
                      setMotivationalMessage(msg);
                      setShowMotivation(true);
                      
                      // Ocultar el mensaje despu√©s de 5 segundos
                      setTimeout(() => {
                          setShowMotivation(false);
                          setMotivationalMessage(''); // Limpiar el mensaje despu√©s de ocultarlo
                      }, 5*1000); 
                  }
              } else {
                   setMotivationalMessage('');
                   setShowMotivation(false);
              }
          };

          useEffect(() => {
            if (!streak) {
              setMilestones([]);
              return;
            }

            const currentStreak = Number(streak);
            if (isNaN(currentStreak) || currentStreak < 0) return;

            const today = new Date();
            const futureMilestones = new Set();
            const limit = currentStreak + 2000; // Buscamos hitos en los pr√≥ximos 2000 d√≠as

            // --- L√ìGICA DE C√ÅLCULO DE HITOS ---

            // 1. M√∫ltiplos de 30 d√≠as (Meses) - LIMITADO A LOS PR√ìXIMOS 3
            let monthsFound = 0;
            for (let days = 30; days <= limit; days += 30) {
              if (days > currentStreak && days+currentStreak <= 365) {
                futureMilestones.add(days);
                monthsFound++;
                if (monthsFound >= 3) break;
              }
            }

            // 2. M√∫ltiplos de 100 - LIMITADO A LOS PR√ìXIMOS 3
            let hundredsFound = 0;
            for (let i = 100; i <= limit; i += 100) {
              if (i > currentStreak) {
                futureMilestones.add(i);
                hundredsFound++;
                if (hundredsFound >= 3) break;
              }
            }
            
            // 3. M√∫ltiplos de 250
            for (let i = 250; i <= limit; i += 250) futureMilestones.add(i);
            
            // 4. M√∫ltiplos de 500 / 1000 (Grandes hitos - No limitados)
            for (let i = 500; i <= limit; i += 500) futureMilestones.add(i);

            // 5. M√∫ltiplos de 365 (A√±os - No limitados)
            for (let i = 365; i <= limit; i += 365) futureMilestones.add(i);

            // Filtrar los que ya pasaron y ordenar
            const sortedMilestones = Array.from(futureMilestones)
              .filter(m => m > currentStreak)
              .sort((a, b) => a - b)
              .slice(0, 15);

            // Crear objetos con la data completa
            const results = sortedMilestones.map(m => {
              const daysDiff = m - currentStreak;
              const targetDate = new Date();
              targetDate.setDate(today.getDate() + daysDiff);
              
              // Determinar etiquetas especiales
              let label = '';
              let isMajor = false; // Dorado (A√±os, 500s)
              let isMedium = false; // Azul (Meses exactos)

              if (m % 365 === 0) {
                label = `${m / 365} A√±o${m / 365 > 1 ? 's' : ''}`;
                isMajor = true;
              } 
              // Si es m√∫ltiplo de 500 o 1000, se marca como 'isMajor' para el estilo, pero la etiqueta queda vac√≠a.
              else if (m % 500 === 0) {
                isMajor = true;
              } 
              // Si es m√∫ltiplo de 30 y no choca con un m√∫ltiplo de 100
              else if (m % 30 === 0 && m % 100 !== 0) {
                label = `${m / 30} Meses`;
                isMedium = true;
              }

              return {
                target: m,
                date: targetDate,
                daysLeft: daysDiff,
                label: label,
                isMajor: isMajor,
                isMedium: isMedium
              };
            });

            setMilestones(results);
          }, [streak]);

          return (
            <div className="min-h-screen bg-gray-100 font-sans text-gray-700 pb-10">
              
              {/* Header estilo App */}
              <header className="bg-white border-b-2 border-gray-200 sticky top-0 z-10">
                <div className="max-w-2xl mx-auto px-4 py-3 flex items-center justify-between">
                  <div className="flex items-center gap-2">
                    <span className="w-8 h-8 text-yellow-400 fill-current text-2xl">üèÜ</span>
                    {/* T√≠tulo actualizado */}
                    <h1 className="text-xl font-bold text-gray-400 tracking-wide uppercase">Duo Streak Birthdays</h1>
                  </div>
                  <div className="bg-orange-100 px-3 py-1 rounded-xl flex items-center gap-2 border-2 border-orange-200">
                     <span className="w-5 h-5 text-orange-500 fill-current animate-pulse text-xl">üî•</span>
                     <span className="font-bold text-orange-500">{streak || 0}</span>
                  </div>
                </div>
              </header>

              <main className="max-w-xl mx-auto px-4 mt-8">
                
                {/* Card de Input Principal */}
                <div className="bg-white rounded-2xl p-6 shadow-sm border-2 border-gray-200 mb-8">
                  <label className="block text-center text-lg font-bold text-gray-700 mb-4">
                    ¬øCu√°l es tu racha actual?
                  </label>
                  <div className="relative max-w-xs mx-auto">
                    <input
                      type="text"
                      inputMode="numeric"
                      pattern="[0-9]*"
                      value={streak}
                      onChange={handleStreakChange}
                      onBlur={handleBlur} // Agregado el evento onBlur
                      placeholder="0"
                      className={`w-full text-center text-4xl font-black text-gray-800 border-2 rounded-xl py-4 focus:outline-none focus:ring-4 transition-all placeholder-gray-300 ${
                        error 
                          ? 'border-red-500 focus:border-red-500 focus:ring-red-500/20' 
                          : 'border-gray-200 focus:border-green-500 focus:ring-green-500/20'
                      }`}
                      aria-invalid={!!error}
                      aria-describedby="input-error"
                      autoFocus
                    />
                    <div className="absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none">
                      <span className="w-8 h-8 text-gray-200 text-2xl">üî•</span>
                    </div>
                  </div>
                  {error && (
                    <p id="input-error" role="alert" className="text-red-500 text-sm mt-2 text-center font-medium">
                      {error}
                    </p>
                  )}
                  <p className="text-center text-gray-400 text-sm mt-4 font-medium">
                    Ingresa tus d√≠as para ver tus pr√≥ximos logros
                  </p>
                </div>

                {/* Mensaje Motivacional Temporal */}
                {showMotivation && motivationalMessage && (
                    <div 
                        className="bg-green-100 border-2 border-green-500 text-green-800 p-4 rounded-xl mb-6 text-center shadow-lg transition-opacity duration-500"
                        style={{ opacity: showMotivation ? 1 : 0 }}
                    >
                        <span className="w-5 h-5 inline mr-2 text-green-600 fill-current animate-pulse text-xl">‚≠ê</span>
                        <span className="font-semibold">{motivationalMessage}</span>
                    </div>
                )}

                {/* Lista de Resultados */}
                <div className="space-y-4">
                  {streak && milestones.length > 0 ? (
                    <>
                      <h2 className="text-gray-400 font-bold uppercase tracking-widest text-sm ml-2 mb-4">Tu L√≠nea de Tiempo</h2>
                      {milestones.map((item, index) => (
                        <div 
                          key={item.target}
                          className={`relative group overflow-hidden rounded-2xl border-b-4 transition-all hover:scale-[1.02] ${
                            item.isMajor 
                              ? 'bg-yellow-400 border-yellow-600 text-white' 
                              : item.isMedium
                                ? 'bg-blue-500 border-blue-700 text-white' // Nuevo estilo para meses
                                : 'bg-white border-gray-200 text-gray-700'
                          }`}
                          role="listitem"
                        >
                          <div className="p-4 flex items-center justify-between">
                            <div className="flex items-center gap-4">
                              {/* Icono izquierdo */}
                              <div className={`w-12 h-12 rounded-xl flex items-center justify-center shrink-0 text-2xl ${
                                item.isMajor ? 'bg-white/20' : item.isMedium ? 'bg-white/20' : 'bg-green-100'
                              }`}>
                                {item.isMajor ? (
                                  <span>üèÜ</span>
                                ) : item.isMedium ? (
                                  <span>üìÖ</span>
                                ) : (
                                  <span className="text-green-500">üî•</span>
                                )}
                              </div>
                              
                              {/* Info principal */}
                              <div className="flex flex-col">
                                <div className="flex items-center gap-2">
                                  <span className={`text-2xl font-black ${
                                    item.isMajor || item.isMedium ? 'text-white' : 'text-green-500'
                                  }`}>
                                    {item.target}
                                  </span>
                                  {/* Etiqueta de Mes/A√±o si existe */}
                                  {item.label && (
                                    <span className={`text-xs font-bold px-2 py-0.5 rounded-lg uppercase tracking-wide ${
                                      item.isMajor 
                                        ? 'bg-yellow-600/30 text-yellow-50' 
                                        : item.isMedium 
                                          ? 'bg-blue-700/30 text-blue-50'
                                          : 'bg-gray-100 text-gray-500'
                                    }`}>
                                      {item.label}
                                    </span>
                                  )}
                                </div>
                                <span className={`text-sm font-bold opacity-90 capitalize`}>
                                  {formatDate(item.date)}
                                </span>
                              </div>
                            </div>

                            {/* D√≠as restantes */}
                            <div className="text-right">
                              <span className={`text-xs font-bold uppercase tracking-wide block ${
                                item.isMajor || item.isMedium ? 'text-white/70' : 'text-gray-400'
                              }`}>
                                Faltan
                              </span>
                              <span className={`text-lg font-bold ${
                                item.isMajor || item.isMedium ? 'text-white' : 'text-gray-600'
                              }`}>
                                {item.daysLeft} d√≠as
                              </span>
                            </div>
                          </div>
                        </div>
                      ))}
                    </>
                  ) : (
                    // Estado vac√≠o / Bienvenida
                    <div className="text-center py-10 opacity-50">
                      <img 
                        src="https://cdn-icons-png.flaticon.com/512/616/616490.png" 
                        alt="Icono calendario"
                        className="w-24 h-24 mx-auto mb-4 grayscale opacity-50" 
                        onError={(e) => e.target.style.display = 'none'}
                      />
                      <p className="font-bold text-gray-400">¬°Escribe tu racha arriba!</p>
                    </div>
                  )}
                </div>
              </main>

              <footer className="mt-12 text-center text-gray-400 text-xs font-bold uppercase tracking-widest pb-8">
                Sigue as√≠, ¬°vas genial!
              </footer>
            </div>
          );
        };

        // Renderiza el componente App en el div 'root'
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);

    </script>
</body>
</html>
